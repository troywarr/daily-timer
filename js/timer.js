// Generated by CoffeeScript 1.6.3
(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define(["./utils"],function(t){var n;return n=function(){function n(t,n,r,i){this.$container=t;this.bar=n;this.time=r;this.doneCallback=i;this._update=e(this._update,this);this.speed=100;this.finished=!1}n.prototype._getHumanTime=function(e,n){var r,i,s,o,u,a,f,l,c;n==null&&(n=!1);s=e%1e3;e=parseInt(e/1e3,0);u=e%60;e=parseInt(e/60,0);i=e%60;e=parseInt(e/60,0);r=e%24;o=[];c=[r,i,u];for(f=0,l=c.length;f<l;f++){a=c[f];o.push(t.lPad(a,2))}o=o.join(":");s!=null&&n&&(o+="."+t.lPad(s,3));return o};n.prototype._update=function(){var e;e=this.counter*this.speed;this.time.elapsed.current=(new Date).getTime()-this.time.start;if(this.time.elapsed.total+this.time.elapsed.current>=this.time.end){this.finished=!0;this.stop();return this.doneCallback()}this.counter++;this._updateDisplay();return this.timeout=setTimeout(this._update,this.speed-(this.time.elapsed.current-e))};n.prototype._initDisplayTime=function(){this.$elapsed.text(this._getHumanTime(this.time.elapsed.total));return this.$end.text(this._getHumanTime(this.time.end))};n.prototype._updateDisplay=function(){var e;e=this.time.elapsed.total+this.time.elapsed.current;this.$elapsed.text(this._getHumanTime(e));return this.bar.update(e/this.time.end)};n.prototype._getShortcuts=function(){this.$elapsed=this.$container.find(".elapsed");return this.$end=this.$container.find(".end")};n.prototype._initTime=function(){return this.time.elapsed={total:0,current:0}};n.prototype.start=function(){if(!this.finished){this.counter=0;this.time.start=(new Date).getTime();return this.timeout=setTimeout(this._update,this.speed)}};n.prototype.stop=function(){clearTimeout(this.timeout);this.time.elapsed.total+=this.time.elapsed.current;this.time.elapsed.current=0;return this._updateDisplay()};n.prototype.init=function(){this._getShortcuts();this._initTime();return this._initDisplayTime()};return n}()})}).call(this);