// Generated by CoffeeScript 1.6.3
(function(){var e,t,n,r,i,s,o,u=function(e,t){return function(){return e.apply(t,arguments)}};o={lPad:function(e,t,n){n==null&&(n="0");e+="";return e.length>=t?e:(new Array(t-e.length+1)).join(n)+e},requireTemplate:function(e){var t;t={name:e};t.id="template_"+t.name;t.script=$("#"+t.id);if(t.script.length===0){t.dir="./templates";t.url=""+t.dir+"/"+t.name+".tmpl";$.ajax({url:t.url,method:"GET",async:!1,contentType:"text",success:function(e){return t.string=e}});return $("head").append('<script id="'+t.id+'" type="text/template">'+t.string+"</script>")}}};i={second:1e3,minute:6e4,hour:36e5};s=[{name:"Mass Relevance",time:{end:5*i.hour+45*i.minute}},{name:"Exercise (Cardio)",time:{end:30*i.minute}},{name:"Exercise (Strength Training)",time:{end:1*i.hour}},{name:"Sneeze",time:{end:3*i.second}}];n=function(){function e(e,t){this.$container=e;this.tasks=t;this.taskList=[]}e.prototype._insertTasks=function(){var e,n,r,i,s,o;s=this.tasks;o=[];for(r=0,i=s.length;r<i;r++){n=s[r];e=new t(this.$container,n);e.init();o.push(this.taskList.push(e))}return o};e.prototype.init=function(){return this._insertTasks()};return e}();t=function(){function t(e,t){this.$parentContainer=e;this.taskData=t;this.done=u(this.done,this);this._stop=u(this._stop,this);this.taskTmpl=$("#template_task").html();this.running=!1}t.prototype._getShortcuts=function(){this.$time=this.$container.find(".time");return this.$outerBar=this.$container.find(".bar.outer")};t.prototype._render=function(){this.$container=$(_.template(this.taskTmpl,this.taskData));return this.$parentContainer.append(this.$container)};t.prototype._initBar=function(){this.bar=new e(this.$outerBar);return this.bar.init()};t.prototype._initTimer=function(){this.timer=new r(this.$time,this.bar,this.taskData.time,this.done);return this.timer.init()};t.prototype._start=function(){this.$container.addClass("running");this.timer.start();return this.running=!0};t.prototype._stop=function(){this.$container.removeClass("running");this.timer.stop();return this.running=!1};t.prototype._handleStartStop=function(){var e=this;return this.$container.on("click",function(){return e.running?e._stop():e._start()})};t.prototype.done=function(){this._stop();this.$container.off("click");return this.$container.addClass("done")};t.prototype.init=function(){this._render();this._getShortcuts();this._initBar();this._initTimer();return this._handleStartStop()};return t}();r=function(){function e(e,t,n,r){this.$container=e;this.bar=t;this.time=n;this.doneCallback=r;this._update=u(this._update,this);this.speed=100;this.finished=!1}e.prototype._getHumanTime=function(e,t){var n,r,i,s,u,a,f,l,c;t==null&&(t=!1);i=e%1e3;e=parseInt(e/1e3,0);u=e%60;e=parseInt(e/60,0);r=e%60;e=parseInt(e/60,0);n=e%24;s=[];c=[n,r,u];for(f=0,l=c.length;f<l;f++){a=c[f];s.push(o.lPad(a,2))}s=s.join(":");i!=null&&t&&(s+="."+o.lPad(i,3));return s};e.prototype._update=function(){var e;e=this.counter*this.speed;this.time.elapsed.current=(new Date).getTime()-this.time.start;if(this.time.elapsed.total+this.time.elapsed.current>=this.time.end){this.finished=!0;this.stop();return this.doneCallback()}this.counter++;this._updateDisplay();return this.timeout=setTimeout(this._update,this.speed-(this.time.elapsed.current-e))};e.prototype._initDisplayTime=function(){this.$elapsed.text(this._getHumanTime(this.time.elapsed.total));return this.$end.text(this._getHumanTime(this.time.end))};e.prototype._updateDisplay=function(){var e;e=this.time.elapsed.total+this.time.elapsed.current;this.$elapsed.text(this._getHumanTime(e));return this.bar.update(e/this.time.end)};e.prototype._getShortcuts=function(){this.$elapsed=this.$container.find(".elapsed");return this.$end=this.$container.find(".end")};e.prototype._initTime=function(){return this.time.elapsed={total:0,current:0}};e.prototype.start=function(){if(!this.finished){this.counter=0;this.time.start=(new Date).getTime();return this.timeout=setTimeout(this._update,this.speed)}};e.prototype.stop=function(){clearTimeout(this.timeout);this.time.elapsed.total+=this.time.elapsed.current;this.time.elapsed.current=0;return this._updateDisplay()};e.prototype.init=function(){this._getShortcuts();this._initTime();return this._initDisplayTime()};return e}();e=function(){function e(e){this.$container=e}e.prototype._getShortcuts=function(){return this.$innerBar=this.$container.find(".bar.inner")};e.prototype.update=function(e){return this.$innerBar.css("width",""+e*100+"%")};e.prototype.init=function(){return this._getShortcuts()};return e}();$(function(){var e;o.requireTemplate("task");e=new n($(".task-list"),s);return e.init()})}).call(this);